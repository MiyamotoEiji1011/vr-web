<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkyWay VR Cinema | High-Immersion Mode</title>
    <link rel="stylesheet" href="style.css" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
  </head>

  <body>
    <header class="topbar">
      <div class="brand">
        <div class="logo">☁️</div>
        <div>
          <div class="title">SkyWay VR Cinema</div>
          <div class="subtitle">1枚の映像に没入するアップグレード版</div>
        </div>
      </div>
      <div class="status">
        <span class="pill" id="conn-pill">未接続</span>
        <span class="muted">ID:</span> <span class="mono" id="my-id">-</span>
        <button id="toggle-vr" class="btn">VRモード</button>
      </div>
    </header>

    <main class="container" id="ui-root">
      <section class="card">
        <h2 class="card-title">接続設定</h2>
        <div class="grid">
          <label class="field">
            <span class="label">Room name</span>
            <input id="room-name" type="text" placeholder="例: vr-cinema-room" />
          </label>
          <div class="field">
            <span class="label">モード</span>
            <div class="segmented">
              <label class="seg-item"><input type="radio" name="mode" value="both" checked /><span>両方</span></label>
              <label class="seg-item"><input type="radio" name="mode" value="publish" /><span>Publishのみ</span></label>
              <label class="seg-item"><input type="radio" name="mode" value="subscribe" /><span>Subscribeのみ</span></label>
            </div>
          </div>
          <div class="field actions">
            <button id="join" class="btn primary">Join</button>
            <button id="leave" class="btn" disabled>Leave</button>
          </div>
        </div>
      </section>

      <section class="two-col">
        <section class="card">
          <div class="card-head"><h2 class="card-title">Local</h2></div>
          <div class="video-wrap">
            <video id="local-video" muted playsinline webkit-playsinline></video>
          </div>
        </section>
        <section class="card">
          <div class="card-head"><h2 class="card-title">Remote</h2></div>
          <div class="remote-tools">
            <label class="toggle"><input id="auto-subscribe" type="checkbox" checked /><span>自動Subscribe</span></label>
          </div>
          <div class="remote-grid" id="remote-media-area"></div>
        </section>
      </section>
    </main>

    <a-scene id="vr-scene" background="color: #000" renderer="antialias: true" vr-mode-ui="enabled: true" embedded>
      <a-assets id="vr-assets"></a-assets>
      <a-entity id="camera-rig" position="0 1.6 0">
        <a-camera id="vr-camera" wasd-controls-enabled="false">
          <a-entity id="vr-screens" position="0 0 -2"></a-entity>
        </a-camera>
      </a-entity>
    </a-scene>

    <div class="vr-hud">
      <div class="vr-hud-left">
        <div class="vr-hud-title">映像切り替え</div>
        <div id="vr-video-selector" class="row"></div>
      </div>
      <div class="vr-controls">
        <label>距離 <input id="vr-z" type="range" min="0.5" max="5.0" step="0.1" value="2.0" /><span id="vr-zv">2.0</span>m</label>
        <label>サイズ <input id="vr-x" type="range" min="0.5" max="4.0" step="0.1" value="1.5" />x<span id="vr-xv">1.5</span></label>
        <input id="vr-y" type="hidden" value="0" /><input id="vr-pitch" type="hidden" value="0" />
      </div>
      <div class="vr-hud-right">
        <button id="exit-vr" class="btn primary">UIに戻る</button>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@skyway-sdk/room/dist/skyway_room-latest.js"></script>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="script.js"></script>
  </body>
</html>